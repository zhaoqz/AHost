{% extends "base.html" %}

{% block title %}{{ app.name }} - AI åº”ç”¨æ‰˜ç®¡{% endblock %}

{% block content %}
<div class="glass rounded-2xl shadow-2xl overflow-hidden max-w-4xl w-full flex flex-col md:flex-row relative">
    <!-- Back to Home -->
    <a href="/"
        class="absolute top-4 left-4 z-10 p-2 bg-white/80 backdrop-blur-sm rounded-full text-gray-600 hover:text-indigo-600 hover:bg-white transition shadow-sm"
        title="è¿”å›é¦–é¡µ">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
    </a>
    <!-- Left Side: Info -->
    <div class="p-8 md:w-1/2 flex flex-col justify-center space-y-6">
        <div>
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">{{ app.name }}</h1>
            <div class="flex flex-wrap items-center text-sm text-gray-500 mt-2 gap-4">
                <span>åˆ›å»ºäº {{ app.created_at[:10] }}</span>
                {% if app.author %}
                <span class="flex items-center"><span class="mr-1">ğŸ‘¤</span> {{ app.author }}</span>
                {% endif %}
                <span class="flex items-center"><span class="mr-1">ğŸ‘ï¸</span> {{ app.view_count }} æ¬¡è®¿é—®</span>
            </div>
        </div>

        <p class="text-gray-600 text-lg leading-relaxed">
            {{ app.description or "æš‚æ— æè¿°ã€‚" }}
        </p>

        <div class="flex items-center space-x-4 pt-4">
            <a href="/{{ app.slug }}" target="_blank"
                class="flex-1 bg-indigo-600 text-white text-center py-3 px-6 rounded-xl font-semibold shadow-lg hover:bg-indigo-700 transition transform hover:-translate-y-1">
                å¯åŠ¨åº”ç”¨ (Launch) ğŸš€
            </a>
            <button onclick="navigator.clipboard.writeText(window.location.origin + '/{{ app.slug }}')"
                class="p-3 rounded-xl border border-gray-300 hover:bg-gray-50 transition text-gray-600 flex items-center justify-center"
                title="å¤åˆ¶é“¾æ¥">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
            </button>
        </div>

        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                        fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"
                            clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-yellow-700">
                        å®‰å…¨æç¤ºï¼šæœ¬ç½‘ç«™ä»…ç”¨äºæ‰˜ç®¡æ¼”ç¤ºç½‘é¡µï¼Œè¯·å‹¿ä¸Šä¼ æ•æ„Ÿæ•°æ®ã€‚
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Side: QR & Preview -->
    <div class="bg-white/50 p-8 md:w-1/2 flex flex-col items-center justify-center border-l border-white/20">
        <div class="bg-white p-4 rounded-xl shadow-lg rotate-2 hover:rotate-0 transition duration-500">
            <img src="{{ qr_code }}" alt="QR Code" class="w-48 h-48 md:w-64 md:h-64 object-contain">
        </div>
        <p class="mt-6 text-gray-500 font-medium text-sm uppercase tracking-wide">æ‰«ç è®¿é—®</p>
    </div>
</div>

<!-- Comments Section -->
<div class="glass rounded-2xl shadow-xl p-8 w-full max-w-4xl mt-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-6">ç•™è¨€æ¿ (Comments)</h2>

    <!-- Comment Form -->
    <form action="/api/comment/{{ app.slug }}" method="post" class="mb-8 space-y-4">
        <div class="flex flex-col md:flex-row gap-4">
            <input type="text" name="author" placeholder="æ‚¨çš„æ˜µç§° (Name)" required
                class="w-full md:w-1/3 px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition">
            <input type="text" name="content" placeholder="å†™ä¸‹æ‚¨çš„è¯„è®º... (Write a comment)" required
                class="w-full md:w-2/3 px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition">
            <button type="submit"
                class="w-full md:w-auto px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium whitespace-nowrap">
                å‘é€
            </button>
        </div>
    </form>

    <!-- Comments List -->
    <div class="space-y-4">
        {% for comment in comments %}
        <div class="bg-white/60 p-4 rounded-lg border border-white/40">
            <div class="flex justify-between items-start mb-1">
                <span class="font-bold text-gray-800">{{ comment.author }}</span>
                <span class="text-xs text-gray-500">{{ comment.created_at[:19] }}</span>
            </div>
            <p class="text-gray-700">{{ comment.content }}</p>
        </div>
        {% else %}
        <p class="text-gray-500 text-center py-4">æš‚æ— ç•™è¨€ï¼Œå¿«æ¥æŠ¢æ²™å‘å§ï¼</p>
        {% endfor %}
    </div>
</div>
{% endblock %}